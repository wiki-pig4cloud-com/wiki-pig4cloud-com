---
title: "websocketç®€ä»‹"
---

[bilibili](https://player.bilibili.com/player.html?bvid=BV12t411B7e9&p=36&page=36&autoplay=0)

# websocketç®€ä»‹
WebSocket åè®®åœ¨2008å¹´è¯ç”Ÿï¼Œ2011å¹´æˆä¸ºå›½é™…æ ‡å‡†ã€‚æ‰€æœ‰æµè§ˆå™¨éƒ½å·²ç»æ”¯æŒäº†ã€‚

å®ƒçš„æœ€å¤§ç‰¹ç‚¹å°±æ˜¯ï¼ŒæœåŠ¡å™¨å¯ä»¥ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€ä¿¡æ¯ï¼Œå®¢æˆ·ç«¯ä¹Ÿå¯ä»¥ä¸»åŠ¨å‘æœåŠ¡å™¨å‘é€ä¿¡æ¯ï¼Œæ˜¯çœŸæ­£çš„åŒå‘å¹³ç­‰å¯¹è¯ï¼Œå±äº[æœåŠ¡å™¨æ¨é€æŠ€æœ¯](https://en.wikipedia.org/wiki/Push_technology)çš„ä¸€ç§ã€‚

![](https://cdn.nlark.com/yuque/0/2022/png/283679/1668404250586-a165fd51-9378-4d71-bfab-a5b9d038bd30.png)



# ä¸Šæ‰‹ä½¿ç”¨
## â‘  æ·»åŠ ä¾èµ–
```xml
<dependency>
  <groupId>com.pig4cloud.plugin</groupId>
  <artifactId>websocket-spring-boot-starter</artifactId>
  <version>3.0.0</version>
</dependency>
```

## â‘¡ æµ‹è¯•ä½¿ç”¨
<Warning>
ğŸ‘‰ ä½¿ç”¨ [websocket åœ¨çº¿æµ‹è¯•å·¥å…·è°ƒè¯•](https://wstool.js.org/)


</Warning>

![](https://cdn.nlark.com/yuque/0/2023/png/283679/1698816912994-3c28de13-39de-404a-b399-be537303484d.png)



+ æœåŠ¡åœ°å€:  

```shell
# ä¾‹å¦‚é“¾æ¥upmsæ¨¡å—çš„wsæ¥å£ ws://127.0.0.1:9999/admin/ws/info?access_token=xxxx 
ws://127.0.0.1:9999/è·¯ç”±å‰ç¼€/ws/info?access_token=token
```

# è¿›é˜¶ä½¿ç”¨
## â‘  æœåŠ¡ç«¯æ¨é€æ¶ˆæ¯
```java
// åœ¨æœåŠ¡ç«¯éœ€è¦å‘é€ ws ç»™å®¢æˆ·ç«¯å‘é€å‡ºï¼Œç›´æ¥ä½¿ç”¨å¦‚ä¸‹å·¥å…·ç±»å‘é€
WebSocketMessageSender.send(sessionKey,message)
```

<Warning>
é»˜è®¤sessionKeyä¸ºå®¢æˆ·ç«¯ç™»å½•çš„ç”¨æˆ·åï¼Œæ¯”å¦‚ç»™admin ç”¨æˆ·å‘é€å°±æ˜¯   
  
WebSocketMessageSender.send("admin","hello world")


</Warning>

## â‘¡ ä¸ªæ€§åŒ–å®¢æˆ·ç«¯æ¶ˆæ¯å¤„ç†
+ é»˜è®¤ç›´æ¥è¾“å‡ºå®¢æˆ·ç«¯è¯·æ±‚çš„æ¶ˆæ¯

![](https://cdn.nlark.com/yuque/0/2022/png/283679/1668405374784-cef210f4-f49e-4f0d-928e-29fa947862e0.png)



+ æ³¨å…¥ Spring PlanTextMessageHandler  å®ç°å³å¯

```java
@Service
public class CustomPlanTextMessageHandler implements PlanTextMessageHandler {

	/**
	 * æ™®é€šæ–‡æœ¬æ¶ˆæ¯å¤„ç†
	 * @param session å½“å‰æ¥æ”¶æ¶ˆæ¯çš„session
	 * @param message æ–‡æœ¬æ¶ˆæ¯
	 */
	@Override
	public void handle(WebSocketSession session, String message) {
		log.info("sessionId {} ,msg {}", session.getId(), message);
	}

}
```

