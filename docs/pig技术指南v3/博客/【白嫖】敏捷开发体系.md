[bilibili](https://player.bilibili.com/player.html?bvid=BV1SU4y1B7Mn)

![](https://minio.pigx.vip/oss/1661304882.jpg)



## 云效介绍
<font style="color:rgb(61, 61, 61);">云原生时代一站式BizDevOps平台，数十万企业都在用。支持公共云、专有云和混合云多种部署形态，通过云原生新技术和研发新模式，助力创新创业和数字化转型企业快速实现研发敏捷和组织敏捷，打造“双敏”组织，实现多倍效能提升。</font>

:::warning
**<font style="color:rgb(61, 61, 61);">重点： 如上图所示的阿里云效组件  全部免费、没有成员限制</font>**

:::



## ① 开通云效
+ [**使用阿里云账号登录开通云效功能**](https://devops.aliyun.com/workbench?source=5176.11533457&userCode=ueyxv2qf)

![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661477197791-e2e530c7-3dcc-4686-9230-bbf9c77968d9.png)



## ② 代码托管
#### [访问代码托管](https://codeup.aliyun.com?source=5176.11533457&userCode=ueyxv2qf)
![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661479516215-92f6149b-6df1-48e8-a4e7-85460e976f8c.png)

#### 导入代码
  ![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661479810461-75f59274-29e4-4470-bdf6-6e80f65708a1.png)



![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661479877234-dbd9dbab-1328-4f65-abd9-b99bc9aa2096.png)



#### 设置账号密码
:::warning
+ 设置独立的账号密码 方便克隆、推送代码  [设置 https账号密码](https://account-devops.aliyun.com/settings/httpsPw?source=5176.11533457&userCode=ueyxv2qf)

:::

## ③  制品仓库
![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661479976413-b9dc006d-9631-4c89-93ce-3cf1ad1521ca.png)

![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661481660652-31832660-b626-4f4e-93af-67939b7e812f.png)

+ 获取私服账号密码

![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661482342661-de199999-2046-470f-9690-e96298b30028.png)

![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661482076259-347b423e-9720-4183-b637-9ff91ba4e857.png)



### Maven 仓库
#### 获取仓库地址
![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661481718146-24d91e14-ac75-477f-b7dd-b76235324e40.png)

![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661481943286-82def9fd-b607-4469-aa19-dd80449f08a8.png)

#### 修改 maven setting
:::warning
本地 maven  settings.xml 配置 上传仓库 和密码

:::

```java
// 所有的开发都需要设置此代理，后续才能下载私有包
<servers>
  <server>
    <id>rdc-releases</id>
    <username>如上图所示的账号密码</username>
    <password>如上图所示的账号密码password>
  </server>
  <server>
    <id>rdc-snapshots</id>
    <username>如上图所示的账号密码username>
    <password>如上图所示的账号密码password>
  </server>
</servers>

<profiles>
  <profile>
    <id>dev</id>
    <properties>
      <altReleaseDeploymentRepository>
        rdc-releases::default::第一步获取的正式库地址
      </altReleaseDeploymentRepository>
      <altSnapshotDeploymentRepository>
        rdc-snapshots::default::第一步获取的快照库地址
      </altSnapshotDeploymentRepository>
    </properties>
  </profile>
</profiles>

<activeProfiles>
  <activeProfile>dev</activeProfile>
</activeProfiles>
```

#### 推送Jar至私服
Java maven 项目根目录执行

```shell
mvn clean install org.apache.maven.plugins:maven-deploy-plugin:2.8:deploy -DskipTests
```

### Npm 仓库
#### 获取私服地址
![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661482486352-aba9fc18-4e88-4340-af15-7556849099bc.png)

![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661482529403-489fa1e9-145d-4cee-af6b-63435c26234b.png)

```shell
#  所有的开发都需要设置此代理，后续才能下载私有包
npm config set registry=上图获取的地址

npm login 
```

#### 推送代码至私服
```shell
npm publish
```

### Docker 仓库
:::warning
Docker 仓库 并非云效提供的功能，属于独立镜像服务 但是个人版本免费！！！

:::

+ 开通[容器镜像服务](https://cr.console.aliyun.com/cn-shanghai/instance/dashboard?source=5176.11533457&userCode=ueyxv2qf)

![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661483368959-2629d1ea-9afb-40a1-b71f-d2699e5514f9.png)

#### 设置账号密码
![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661483414374-e0d389fd-ef17-49a5-bd44-b9676ce88604.png)

#### 创建命名空间
![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661483444666-5ef30ec7-eefd-41f7-a0bb-7a2b441fb1b9.png)

#### 创建镜像仓库
![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661483577111-6b323a04-0f75-43d9-8de5-2fd11c6a8823.png)



![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661483599185-c689d667-e67a-4929-85fe-2fdbadb54539.png)



#### 获取上传参数
![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661483660152-4d4a8b36-3aba-4c00-915f-f1e51801dcdd.png)



## ④ 流水线自动化构建
### 流水线自动构建Jar 上传私服
:::warning
演示流水线默认提交以后自动构建发布至 maven 仓库

:::

![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661484220190-5183b995-9cf7-4de4-bc16-cd650ab209bd.png)

#### 导入示例项目
+ [https://github.com/pig-mesh/pig](https://github.com/pig-mesh/pig)

#### 创建流水线 
![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661484651374-80e78731-60ff-459d-8f77-811c2ad5e38a.png)

#### 设置触发策略
![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661484762643-a9f0a2a0-a620-4ea9-8e65-22da6289dc15.png)



#### 设置构建任务
![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661484881492-9abdb7d0-d892-4c2e-8905-67ba5d5441e7.png)

```java
mvn clean install org.apache.maven.plugins:maven-deploy-plugin:2.8:deploy -DskipTests
```

![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661484934523-3e986d8d-dbd9-4f0f-8e7b-5bc0ba944e6a.png)

#### 测试运行
![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661484977084-996002cf-5617-4c39-9a3f-e33bbb25dabe.png)

#### 查看流水线日志
![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661485175010-67d88022-2c98-4eaa-a925-4ea47bfae283.png)

![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661485208461-738eecb5-53a4-494d-ba68-a5097d6aca5c.png)

### 流水线自动构建镜像上传镜像仓库


#### 导入示例项目
+ [https://github.com/lltx/datav](https://github.com/lltx/datav)



#### 创建流水线
![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661484651374-80e78731-60ff-459d-8f77-811c2ad5e38a.png)

#### 设置触发策略
![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661485757006-bc76c454-813a-458d-9031-54cfc2a98f2a.png)



#### 设置构建任务


+ 添加任务步骤:   Java 构建

```shell
mvn clean install
```

![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661486148581-ecd296a0-eb83-4e0f-99fb-4a690cd740ae.png)



+ 添加任务步骤： 镜像构建并推送至阿里云镜像仓库个人



![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661485842278-fbcd111b-8a77-423c-a8aa-984a63f89998.png)



+ 添加链接至 docker 仓库

![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661485876705-b17b2d5d-3af2-49e3-b7e5-3b66f13c45d1.png)

![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661485987267-6490fab2-75e1-4b48-84b4-c81fb95711a0.png)

#### 测试运行
![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661486268491-9672218b-8902-4bae-af21-c1feea2eb888.png)

#### 查看流水线日志
![](https://cdn.nlark.com/yuque/0/2022/png/283679/1661486429227-29dda696-d787-4a48-a3e0-8e10d529eead.png)

