![](https://cdn.nlark.com/yuque/0/2023/png/283679/1689225641628-d1150472-3981-46b1-bd3f-a0d8fc7a92e3.png)

## 1. 创建测试数据库及其表


:::warning
**<font style="color:#E8323C;background-color:#FADB14;">注意表字段必须含有 </font>**`create_time` `create_by``update_time` `update_by` 字段，若表不包含则在**<font style="color:#F5222D;background-color:#FADB14;">生成实体代码去掉继承BaseEntity</font>**

:::



```sql
-- 创建测试库
create database `pig_demo` default character set utf8mb4 collate utf8mb4_general_ci;

USE pig_demo;

SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- 创建测试表
DROP TABLE IF EXISTS `demo`;

CREATE TABLE `demo` (
  `id` bigint NOT NULL COMMENT '主键',
  `username` varchar(255) DEFAULT NULL COMMENT '用户名',
  `nicename` varchar(255) DEFAULT NULL COMMENT '昵称',
  `create_time` datetime DEFAULT NULL COMMENT '创建时间',
  `create_by` varchar(64) DEFAULT NULL COMMENT '创建人',
  `update_time` datetime DEFAULT NULL COMMENT '修改时间',
  `update_by` varchar(64) DEFAULT NULL COMMENT '更新人',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 ROW_FORMAT=DYNAMIC COMMENT='demo 表';
```



## 2. 维护数据源 并代码生成


+ **<font style="color:#E8323C;background-color:#FADB14;">启动 PigCodeGenApplication 模块</font>**
+ 开发平台 > 数据源管理 > 新增



```yaml
jdbc:mysql://pig-mysql:3306/pig_demo?characterEncoding=utf8&zeroDateTimeBehavior=convertToNull&useSSL=false&useJDBCCompliantTimezoneShift=true&useLegacyDatetimeCode=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true
```



![](https://cdn.nlark.com/yuque/0/2021/png/283679/1612090022990-26f24955-2499-46e8-bfb0-c7c3cd10fbc7.png)



## 3. 代码生成


+ 开发平台 > 代码生成



:::warning
**<font style="color:#F5222D;">选择数据源生成代码,注意包名称、模块名称 注意和archetype 一致</font>**

:::



![](https://minio.pigx.vip/oss/1628661177.png)



### 4.  生成代码导入


#### 4.1  后端代码 导入


:::info
**<font style="color:#F5222D;">将代码生成的demo/pig/src 移动到骨架工程生成 demo/demo-biz/src 合并</font>**

:::



![](https://cdn.nlark.com/yuque/0/2020/png/283679/1599233210275-93846c45-d712-4c44-ae30-2c79aa554169.png)

![](https://cdn.nlark.com/yuque/0/2020/png/283679/1599233210290-f45546eb-7d38-4608-a550-6c1dc596e941.png)



#### 4.2 前端代码 导入


:::info
**<font style="color:#F5222D;">将代码生成的demo/pig-ui/src 移动到原有pig-ui/src  合并</font>**

:::



![](https://cdn.nlark.com/yuque/0/2021/png/283679/1612090022984-b760fff0-dade-4198-9af6-f29f347e89cc.png)

![](https://cdn.nlark.com/yuque/0/2020/png/283679/1599233210289-7f0625e6-f138-4a8c-9bbc-3d1f9c30485b.png)



#### 4.3  菜单脚本执行


:::info
**<font style="color:#F5222D;">在 pig 库 执行菜单插入</font>**

:::



![](https://cdn.nlark.com/yuque/0/2020/png/283679/1599233210304-2c6aabb6-f8a5-49e4-a57e-3cc6d5b08b18.png)



## 5. 检查 `demo-biz` 数据库配置信息


![](https://cdn.nlark.com/yuque/0/2021/png/283679/1612090023053-501986c4-d5e0-4743-a737-1a5ef83159d4.png)



```yaml
# spring security 配置
security:
  oauth2:
    client:
      client-id: pig
      client-secret: pig
      scope: server

# 数据源配置
spring:
  datasource:
    type: com.zaxxer.hikari.HikariDataSource
    driver-class-name: com.mysql.cj.jdbc.Driver
    username: root
    password: root
    url: jdbc:mysql://pig-mysql:3306/pig_demo?characterEncoding=utf8&zeroDateTimeBehavior=convertToNull&useSSL=false&useJDBCCompliantTimezoneShift=true&useLegacyDatetimeCode=false&serverTimezone=Asia/Shanghai
```



## 6. 配置网关路由


> <font style="color:#F5222D;">[info] </font>`<font style="color:#F5222D;">nacos/pig-gateway-dev.yml</font>`<font style="color:#F5222D;">  配置完毕注意</font>**<font style="color:#F5222D;">重启网关</font>**
>



![](https://cdn.nlark.com/yuque/0/2020/png/283679/1599233210297-bc8de7e2-dbc0-4f03-b4e0-329137b3fa92.png)



```yaml
spring:
  cloud:
    gateway:
      routes:
        # demo模块
        - id: pig-demo
          uri: lb://demo-biz
          predicates:
            - Path=/demo/**
```



## 7. 执行代码生成包的SQL


:::info
1. **<font style="color:#F5222D;">给角色分配权限  （角色管理 > 权限）</font>**
2. <font style="color:#F5222D;">退出登录， 重启前端</font>
3. <font style="color:#F5222D;">强制刷新浏览器，查看demo功能</font>

:::

## ❤  问题咨询
![](https://cdn.nlark.com/yuque/0/2022/gif/283679/1662563973685-c22e9831-db66-42b5-973f-886d25d1e0e7.gif)

